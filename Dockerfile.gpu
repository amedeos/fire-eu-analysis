# fire-eu-analysis GPU Dockerfile

# Recent CUDA + Ubuntu 24.04 base image with cuDNN included
FROM nvidia/cuda:13.0.2-cudnn-runtime-ubuntu24.04

ENV LC_ALL=C.UTF-8
ENV LANG=C.UTF-8
ENV DEBIAN_FRONTEND=noninteractive

# ------------------------------------------------------------
# 1. System packages
#    - python3-venv needed to create a virtual environment
# ------------------------------------------------------------
RUN apt-get update && apt-get install -y --no-install-recommends \
    python3 python3-pip python3-venv \
    build-essential \
    git \
    && rm -rf /var/lib/apt/lists/*

# ------------------------------------------------------------
# 2. Create and activate a virtual environment
# ------------------------------------------------------------
RUN python3 -m venv /opt/venv
# Make sure the venv is used for all subsequent commands
ENV PATH="/opt/venv/bin:${PATH}"

# ------------------------------------------------------------
# 3. Workdir
# ------------------------------------------------------------
WORKDIR /workspace

# ------------------------------------------------------------
# 4. Install Python dependencies into the venv
# ------------------------------------------------------------
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# ------------------------------------------------------------
# 5. Project files (overridden by bind mount in dev)
# ------------------------------------------------------------
COPY . .

# ------------------------------------------------------------
# 6. Local modules importable
# ------------------------------------------------------------
ENV PYTHONPATH=/workspace

# ------------------------------------------------------------
# 7. Default command
# ------------------------------------------------------------
CMD ["bash"]

